<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>äº’å‹•å¼é›¶çŸ¥è­˜è­‰æ˜ï¼šé˜¿é‡Œå·´å·´çš„æ´ç©´</title>
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 800px;
        margin: 20px auto;
        padding: 0 20px;
        background-color: #f9f9f9;
    }
    h1, h2 {
        text-align: center;
        color: #2c3e50;
    }
    .container {
        background: #fff;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .cave-container {
        position: relative;
        width: 300px;
        height: 150px;
        margin: 30px auto;
        border: 3px dashed #7f8c8d;
        border-radius: 150px 150px 0 0;
        border-bottom: none;
    }
    .prover {
        position: absolute;
        width: 30px;
        height: 30px;
        background-color: #3498db;
        color: white;
        text-align: center;
        line-height: 30px;
        border-radius: 50%;
        font-weight: bold;
        transition: all 0.8s ease-in-out;
    }
    #prover-peggy {
        bottom: -40px;
        left: 135px;
    }
    .path-label {
        position: absolute;
        bottom: 10px;
        font-weight: bold;
        color: #7f8c8d;
    }
    #path-a { left: 40px; }
    #path-b { right: 40px; }
    .buttons {
        text-align: center;
        margin: 20px 0;
    }
    button {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin: 5px;
        transition: background-color 0.3s;
    }
    button:disabled {
        background-color: #bdc3c7;
        cursor: not-allowed;
    }
    button:hover:not(:disabled) {
        background-color: #2980b9;
    }
    .explanation {
        margin-top: 20px;
        padding: 15px;
        background-color: #ecf0f1;
        border-left: 5px solid #3498db;
        border-radius: 4px;
    }
    .result {
        text-align: center;
        font-size: 1.2em;
        font-weight: bold;
        margin-top: 15px;
    }
    #confidence {
        width: 100%;
        -webkit-appearance: none;
        appearance: none;
        height: 10px;
        background: #ddd;
        border-radius: 5px;
        outline: none;
    }
    #confidence::-webkit-progress-bar {
        background-color: #ddd;
        border-radius: 5px;
    }
    #confidence::-webkit-progress-value {
        background-color: #2ecc71;
        border-radius: 5px;
    }
    #confidence::-moz-progress-bar {
        background-color: #2ecc71;
        border-radius: 5px;
    }
</style>
</head>
<body>

<div class="container">
    <h1>äº’å‹•å¼é›¶çŸ¥è­˜è­‰æ˜</h1>
    <h2>é˜¿é‡Œå·´å·´çš„æ´ç©´ ğŸº</h2>

    <div class="explanation">
        <p><strong>æ‚¨ (è­‰æ˜è€…)</strong> çŸ¥é“ä¸€å€‹ç’°å½¢æ´ç©´æ·±è™•é­”æ³•é–€çš„å’’èªã€‚æ‚¨çš„<strong>æœ‹å‹ (é©—è­‰è€…)</strong> ç«™åœ¨æ´å¤–ï¼Œæƒ³ç¢ºèªæ‚¨æ˜¯å¦çœŸçš„çŸ¥é“å’’èªï¼Œä½†æ‚¨ä¸èƒ½è®“ä»–è½åˆ°å’’èªã€‚</p>
        <p><strong>è¦å‰‡ï¼š</strong></p>
        <ol>
            <li>æ‚¨éš¨æ©Ÿå¾ A æˆ– B å…¥å£é€²å…¥æ´ç©´ï¼ˆæœ‹å‹æ­¤æ™‚æœƒé–‰ä¸Šçœ¼ç›ï¼‰ã€‚</li>
            <li>æœ‹å‹éš¨æ©Ÿå–Šå‡ºä¸€å€‹å‡ºå£ï¼ˆA æˆ– Bï¼‰ï¼Œè¦æ±‚æ‚¨å¾è©²å‡ºå£å‡ºä¾†ã€‚</li>
            <li>å¦‚æœæ‚¨çŸ¥é“å’’èªï¼Œå°±èƒ½æ‰“é–‹é­”æ³•é–€ï¼Œç¸½æ˜¯èƒ½å¾æŒ‡å®šçš„å‡ºå£å‡ºä¾†ã€‚å¦‚æœä¸çŸ¥é“ï¼Œæ‚¨åªæœ‰ 50% çš„æ©Ÿç‡çŒœå°ã€‚</li>
        </ol>
    </div>

    <div id="game">
        <div class="cave-container">
            <div id="prover-peggy" class="prover">æ‚¨</div>
            <div id="path-a" class="path-label">A</div>
            <div id="path-b" class="path-label">B</div>
        </div>

        <div class="buttons">
            <button id="start-round" onclick="startRound()">ç¬¬ 1 æ­¥ï¼šé€²å…¥æ´ç©´</button>
            <p id="verifier-choice-text" style="display:none; margin-top: 15px; font-weight:bold;"></p>
            <button id="call-a" onclick="verifierCall('A')" disabled>æœ‹å‹è¦æ±‚å¾ A å‡ºä¾†</button>
            <button id="call-b" onclick="verifierCall('B')" disabled>æœ‹å‹è¦æ±‚å¾ B å‡ºä¾†</button>
        </div>

        <div class="result" id="result-text"></div>

        <div>
            <p style="text-align:center; margin-bottom: 5px;">æœ‹å‹çš„ä¿¡ä»»åº¦ï¼š<span id="confidence-percent">0%</span></p>
            <progress id="confidence" value="0" max="100"></progress>
        </div>
         <div class="buttons">
            <button id="reset-button" onclick="resetGame()" style="background-color: #e74c3c;">é‡æ–°é–‹å§‹</button>
        </div>
    </div>
</div>

<script>
    let proverChoice = '';
    let round = 0;
    let successfulRounds = 0;

    const prover = document.getElementById('prover-peggy');
    const startButton = document.getElementById('start-round');
    const callAButton = document.getElementById('call-a');
    const callBButton = document.getElementById('call-b');
    const resultText = document.getElementById('result-text');
    const verifierChoiceText = document.getElementById('verifier-choice-text');
    const confidenceBar = document.getElementById('confidence');
    const confidencePercent = document.getElementById('confidence-percent');
    const resetButton = document.getElementById('reset-button');


    function startRound() {
        // è­‰æ˜è€…éš¨æ©Ÿé¸æ“‡ä¸€å€‹å…¥å£
        proverChoice = Math.random() < 0.5 ? 'A' : 'B';
        
        // è¦–è¦ºåŒ–ï¼šè­‰æ˜è€…é€²å…¥æ´ç©´
        prover.style.transition = 'all 0.8s ease-in-out';
        if (proverChoice === 'A') {
            prover.style.transform = 'translate(-100px, -100px)';
        } else {
            prover.style.transform = 'translate(100px, -100px)';
        }
        
        resultText.textContent = `æ‚¨é¸æ“‡äº†å¾ ${proverChoice} å…¥å£é€²å…¥æ´ç©´æ·±è™•ã€‚`;
        
        startButton.disabled = true;

        // æ¨¡æ“¬é©—è­‰è€…ç­‰å¾…å¾Œåšæ±ºå®š
        setTimeout(() => {
            verifierChoiceText.textContent = "ç¬¬ 2 æ­¥ï¼šæœ‹å‹éš¨æ©Ÿé¸æ“‡ä¸€å€‹å‡ºå£...";
            verifierChoiceText.style.display = 'block';
            callAButton.disabled = false;
            callBButton.disabled = false;
        }, 1000);
    }

    function verifierCall(verifierChoice) {
        callAButton.disabled = true;
        callBButton.disabled = true;
        verifierChoiceText.style.display = 'none';
        round++;
        
        // è­‰æ˜è€…å¾æŒ‡å®šå‡ºå£å‡ºä¾†
        if (verifierChoice === 'A') {
            prover.style.transform = 'translate(-120px, 0px)';
        } else {
            prover.style.transform = 'translate(120px, 0px)';
        }
        
        successfulRounds++;
        resultText.innerHTML = `æœ‹å‹è¦æ±‚æ‚¨å¾ ${verifierChoice} å‡ºä¾†ã€‚<br>å› ç‚ºæ‚¨çŸ¥é“å’’èªï¼Œæ‚¨æˆåŠŸå¾ ${verifierChoice} å‡ºå£èµ°å‡ºï¼`;
        
        // æ›´æ–°ä¿¡ä»»åº¦
        // ä¿¡ä»»åº¦ = 1 - (1/2)^n
        let confidenceValue = (1 - Math.pow(0.5, successfulRounds)) * 100;
        confidenceBar.value = confidenceValue;
        confidencePercent.textContent = `${confidenceValue.toFixed(2)}%`;

        if (confidenceValue > 99) {
             resultText.innerHTML += `<br><strong style="color: #27ae60;">æœ‹å‹ç¾åœ¨éå¸¸ç›¸ä¿¡æ‚¨çŸ¥é“ç§˜å¯†äº†ï¼</strong>`;
        }
        
        // æº–å‚™ä¸‹ä¸€è¼ª
        setTimeout(() => {
            prover.style.transform = 'translate(0, 0)'; // å›åˆ°åŸä½
             setTimeout(() => {
                resultText.textContent = `æº–å‚™é€²è¡Œç¬¬ ${round + 1} è¼ªè­‰æ˜ã€‚`;
                startButton.disabled = false;
            }, 800);
        }, 2000);
    }

    function resetGame() {
        proverChoice = '';
        round = 0;
        successfulRounds = 0;
        
        prover.style.transform = 'translate(0, 0)';
        resultText.textContent = '';
        verifierChoiceText.style.display = 'none';
        
        confidenceBar.value = 0;
        confidencePercent.textContent = '0%';
        
        startButton.disabled = false;
        callAButton.disabled = true;
        callBButton.disabled = true;
    }

</script>

</body>
</html>
