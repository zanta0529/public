(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const h of e)if(h.type==="childList")for(const x of h.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&n(x)}).observe(document,{childList:!0,subtree:!0});function a(e){const h={};return e.integrity&&(h.integrity=e.integrity),e.referrerPolicy&&(h.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?h.credentials="include":e.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(e){if(e.ep)return;e.ep=!0;const h=a(e);fetch(e.href,h)}})();class rt{constructor(o,a,n){if(a<2||n<2||n>a||a>255||n>255)throw new Error("k å’Œ n å¿…é ˆæ˜¯ 2 åˆ° 255 ä¹‹é–“çš„æ•´æ•¸ï¼Œä¸” k <= nã€‚");if(typeof o!="string")throw new Error("ç§˜å¯†å¿…é ˆæ˜¯å­—ä¸²ã€‚");this.n=a,this.k=n,this.config={bits:8,radix:16,maxShares:255,primitivePolynomials:[null,null,1,3,3,5,3,3,29],logs:new Array(256),exps:new Array(256)},this._secretsJS_initGF(this.config.bits);const e=this._str2hex(o);let h="1"+this._hex2bin(e);const x=this.config.bits,g=h.length%x;g&&(h="0".repeat(x-g)+h),this.processedSecretElements=this._splitNumStringToIntArray(h,x)}_secretsJS_initGF(o){const a=this.config.primitivePolynomials[o];if(!a)throw new Error(`Unsupported bit size for GF: ${o}`);let n=1;for(let e=0;e<this.config.maxShares;e++)this.config.exps[e]=n,this.config.logs[n]=e,n<<=1,n>=256&&(n^=a,n&=this.config.maxShares)}_padLeft(o,a){let n=o.length%a;return n?"0".repeat(a-n)+o:o}_str2hex(o){let a="";for(let n=0;n<o.length;n++){let e=o.charCodeAt(n);e<128?a+=e.toString(16).padStart(2,"0"):e<2048?(a+=(192|e>>6).toString(16).padStart(2,"0"),a+=(128|e&63).toString(16).padStart(2,"0")):e<55296||e>=57344?(a+=(224|e>>12).toString(16).padStart(2,"0"),a+=(128|e>>6&63).toString(16).padStart(2,"0"),a+=(128|e&63).toString(16).padStart(2,"0")):(e=65536+((e&1023)<<10|o.charCodeAt(++n)&1023),a+=(240|e>>18).toString(16).padStart(2,"0"),a+=(128|e>>12&63).toString(16).padStart(2,"0"),a+=(128|e>>6&63).toString(16).padStart(2,"0"),a+=(128|e&63).toString(16).padStart(2,"0"))}return a}_hex2bin(o){let a="";for(let n=0;n<o.length;n++){let e=parseInt(o[n],16);if(isNaN(e))throw new Error("Invalid hex character in _hex2bin.");a+=e.toString(2).padStart(4,"0")}return a}_bin2hex(o){let a="";o=this._padLeft(o,4);for(let n=0;n<o.length;n+=4){let e=o.substring(n,n+4);a+=parseInt(e,2).toString(16)}return a}_hex2str(o){let a="",n=0;for(;n<o.length;){let e,h=parseInt(o.substring(n,n+2),16);if(n+=2,h<128)e=h;else if((h&224)===192){let x=parseInt(o.substring(n,n+2),16);n+=2,e=(h&31)<<6|x&63}else if((h&240)===224){let x=parseInt(o.substring(n,n+2),16);n+=2;let g=parseInt(o.substring(n,n+2),16);n+=2,e=(h&15)<<12|(x&63)<<6|g&63}else if((h&248)===240){let x=parseInt(o.substring(n,n+2),16);n+=2;let g=parseInt(o.substring(n,n+2),16);n+=2;let r=parseInt(o.substring(n,n+2),16);n+=2,e=(h&7)<<18|(x&63)<<12|(g&63)<<6|r&63}else throw new Error("Invalid UTF-8 sequence in hex string.");a+=String.fromCodePoint(e)}return a}_splitNumStringToIntArray(o,a){const n=[];for(let e=0;e<o.length;e+=a)n.push(parseInt(o.substring(e,e+a),2));return n}_getRandomByte(){const o=new Uint8Array(1);return window.crypto.getRandomValues(o),o[0]}_evalPolynomialSJS(o,a){let n=0;const e=this.config.logs[o];for(let h=a.length-1;h>=0;h--)n===0?n=a[h]:n=this.config.exps[(e+this.config.logs[n])%this.config.maxShares]^a[h];return n}generateShares(){const o=[];for(let a=0;a<this.n;a++)o[a]={id:a+1,value:new Array(this.processedSecretElements.length)};for(let a=0;a<this.processedSecretElements.length;a++){const e=[this.processedSecretElements[a]];for(let h=1;h<this.k;h++)e[h]=this._getRandomByte();for(let h=0;h<this.n;h++){const x=o[h].id;o[h].value[a]=this._evalPolynomialSJS(x,e)}}return o}_reconstructElementSJS(o,a){let n=0;const e=0;for(let h=0;h<this.k;h++){if(a[h]===0)continue;let x=this.config.logs[a[h]];for(let g=0;g<this.k;g++)if(h!==g){if(e===o[g]){x=-1;break}x=(x+this.config.logs[e^o[g]]-this.config.logs[o[h]^o[g]]+this.config.maxShares)%this.config.maxShares}n=x===-1?n:n^this.config.exps[x]}return n}reconstructSecret(o){if(o.length<this.k)throw new Error(`è‡³å°‘éœ€è¦ ${this.k} ä»½åˆ†å‰²å€¼æ‰èƒ½é‡å»ºã€‚`);const a=o.slice(0,this.k),n=a[0].value.length;if(!a.every(r=>r.value.length===n))throw new Error("æ‰€æœ‰ç”¨æ–¼é‡å»ºçš„åˆ†å‰²å€¼é•·åº¦å¿…é ˆä¸€è‡´ã€‚");let e="";const h=a.map(r=>r.id);for(let r=0;r<n;r++){const E=a.map(U=>U.value[r]),k=this._reconstructElementSJS(h,E);e+=this._padLeft(k.toString(2),this.config.bits)}const x=e.slice(e.indexOf("1")+1),g=this._bin2hex(x);return this._hex2str(g)}}var ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lt(I){if(Object.prototype.hasOwnProperty.call(I,"__esModule"))return I;var o=I.default;if(typeof o=="function"){var a=function n(){var e=!1;try{e=this instanceof n}catch{}return e?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};a.prototype=o.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(I).forEach(function(n){var e=Object.getOwnPropertyDescriptor(I,n);Object.defineProperty(a,n,e.get?e:{enumerable:!0,get:function(){return I[n]}})}),a}var et={exports:{}};const ht={},ft=Object.freeze(Object.defineProperty({__proto__:null,default:ht},Symbol.toStringTag,{value:"Module"})),nt=lt(ft);var st;function dt(){return st||(st=1,(function(I){(function(){var o="input is invalid type",a=typeof window=="object",n=a?window:{};n.JS_SHA256_NO_WINDOW&&(a=!1);var e=!a&&typeof self=="object",h=!n.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node&&process.type!="renderer";h?n=ct:e&&(n=self);var x=!n.JS_SHA256_NO_COMMON_JS&&!0&&I.exports,g=!n.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",r="0123456789abcdef".split(""),E=[-2147483648,8388608,32768,128],k=[24,16,8,0],U=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],H=["hex","array","digest","arrayBuffer"],w=[];(n.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"}),g&&(n.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(t){return typeof t=="object"&&t.buffer&&t.buffer.constructor===ArrayBuffer});var Q=function(t,l){return function(u){return new A(l,!0).update(u)[t]()}},V=function(t){var l=Q("hex",t);h&&(l=G(l,t)),l.create=function(){return new A(t)},l.update=function(p){return l.create().update(p)};for(var u=0;u<H.length;++u){var c=H[u];l[c]=Q(c,t)}return l},G=function(t,l){var u=nt,c=nt.Buffer,p=l?"sha224":"sha256",s;c.from&&!n.JS_SHA256_NO_BUFFER_FROM?s=c.from:s=function(i){return new c(i)};var d=function(i){if(typeof i=="string")return u.createHash(p).update(i,"utf8").digest("hex");if(i==null)throw new Error(o);return i.constructor===ArrayBuffer&&(i=new Uint8Array(i)),Array.isArray(i)||ArrayBuffer.isView(i)||i.constructor===c?u.createHash(p).update(s(i)).digest("hex"):t(i)};return d},X=function(t,l){return function(u,c){return new P(u,l,!0).update(c)[t]()}},K=function(t){var l=X("hex",t);l.create=function(p){return new P(p,t)},l.update=function(p,s){return l.create(p).update(s)};for(var u=0;u<H.length;++u){var c=H[u];l[c]=X(c,t)}return l};function A(t,l){l?(w[0]=w[16]=w[1]=w[2]=w[3]=w[4]=w[5]=w[6]=w[7]=w[8]=w[9]=w[10]=w[11]=w[12]=w[13]=w[14]=w[15]=0,this.blocks=w):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=t}A.prototype.update=function(t){if(!this.finalized){var l,u=typeof t;if(u!=="string"){if(u==="object"){if(t===null)throw new Error(o);if(g&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!g||!ArrayBuffer.isView(t)))throw new Error(o)}else throw new Error(o);l=!0}for(var c,p=0,s,d=t.length,i=this.blocks;p<d;){if(this.hashed&&(this.hashed=!1,i[0]=this.block,this.block=i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),l)for(s=this.start;p<d&&s<64;++p)i[s>>>2]|=t[p]<<k[s++&3];else for(s=this.start;p<d&&s<64;++p)c=t.charCodeAt(p),c<128?i[s>>>2]|=c<<k[s++&3]:c<2048?(i[s>>>2]|=(192|c>>>6)<<k[s++&3],i[s>>>2]|=(128|c&63)<<k[s++&3]):c<55296||c>=57344?(i[s>>>2]|=(224|c>>>12)<<k[s++&3],i[s>>>2]|=(128|c>>>6&63)<<k[s++&3],i[s>>>2]|=(128|c&63)<<k[s++&3]):(c=65536+((c&1023)<<10|t.charCodeAt(++p)&1023),i[s>>>2]|=(240|c>>>18)<<k[s++&3],i[s>>>2]|=(128|c>>>12&63)<<k[s++&3],i[s>>>2]|=(128|c>>>6&63)<<k[s++&3],i[s>>>2]|=(128|c&63)<<k[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=i[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},A.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,l=this.lastByteIndex;t[16]=this.block,t[l>>>2]|=E[l&3],this.block=t[16],l>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},A.prototype.hash=function(){var t=this.h0,l=this.h1,u=this.h2,c=this.h3,p=this.h4,s=this.h5,d=this.h6,i=this.h7,m=this.blocks,v,_,C,T,y,j,R,J,q,z,D;for(v=16;v<64;++v)y=m[v-15],_=(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3,y=m[v-2],C=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,m[v]=m[v-16]+_+m[v-7]+C<<0;for(D=l&u,v=0;v<64;v+=4)this.first?(this.is224?(J=300032,y=m[0]-1413257819,i=y-150054599<<0,c=y+24177077<<0):(J=704751109,y=m[0]-210244248,i=y-1521486534<<0,c=y+143694565<<0),this.first=!1):(_=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),C=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),J=t&l,T=J^t&u^D,R=p&s^~p&d,y=i+C+R+U[v]+m[v],j=_+T,i=c+y<<0,c=y+j<<0),_=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),C=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),q=c&t,T=q^c&l^J,R=i&p^~i&s,y=d+C+R+U[v+1]+m[v+1],j=_+T,d=u+y<<0,u=y+j<<0,_=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),C=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),z=u&c,T=z^u&t^q,R=d&i^~d&p,y=s+C+R+U[v+2]+m[v+2],j=_+T,s=l+y<<0,l=y+j<<0,_=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),C=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),D=l&u,T=D^l&c^z,R=s&d^~s&i,y=p+C+R+U[v+3]+m[v+3],j=_+T,p=t+y<<0,t=y+j<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+t<<0,this.h1=this.h1+l<<0,this.h2=this.h2+u<<0,this.h3=this.h3+c<<0,this.h4=this.h4+p<<0,this.h5=this.h5+s<<0,this.h6=this.h6+d<<0,this.h7=this.h7+i<<0},A.prototype.hex=function(){this.finalize();var t=this.h0,l=this.h1,u=this.h2,c=this.h3,p=this.h4,s=this.h5,d=this.h6,i=this.h7,m=r[t>>>28&15]+r[t>>>24&15]+r[t>>>20&15]+r[t>>>16&15]+r[t>>>12&15]+r[t>>>8&15]+r[t>>>4&15]+r[t&15]+r[l>>>28&15]+r[l>>>24&15]+r[l>>>20&15]+r[l>>>16&15]+r[l>>>12&15]+r[l>>>8&15]+r[l>>>4&15]+r[l&15]+r[u>>>28&15]+r[u>>>24&15]+r[u>>>20&15]+r[u>>>16&15]+r[u>>>12&15]+r[u>>>8&15]+r[u>>>4&15]+r[u&15]+r[c>>>28&15]+r[c>>>24&15]+r[c>>>20&15]+r[c>>>16&15]+r[c>>>12&15]+r[c>>>8&15]+r[c>>>4&15]+r[c&15]+r[p>>>28&15]+r[p>>>24&15]+r[p>>>20&15]+r[p>>>16&15]+r[p>>>12&15]+r[p>>>8&15]+r[p>>>4&15]+r[p&15]+r[s>>>28&15]+r[s>>>24&15]+r[s>>>20&15]+r[s>>>16&15]+r[s>>>12&15]+r[s>>>8&15]+r[s>>>4&15]+r[s&15]+r[d>>>28&15]+r[d>>>24&15]+r[d>>>20&15]+r[d>>>16&15]+r[d>>>12&15]+r[d>>>8&15]+r[d>>>4&15]+r[d&15];return this.is224||(m+=r[i>>>28&15]+r[i>>>24&15]+r[i>>>20&15]+r[i>>>16&15]+r[i>>>12&15]+r[i>>>8&15]+r[i>>>4&15]+r[i&15]),m},A.prototype.toString=A.prototype.hex,A.prototype.digest=function(){this.finalize();var t=this.h0,l=this.h1,u=this.h2,c=this.h3,p=this.h4,s=this.h5,d=this.h6,i=this.h7,m=[t>>>24&255,t>>>16&255,t>>>8&255,t&255,l>>>24&255,l>>>16&255,l>>>8&255,l&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255];return this.is224||m.push(i>>>24&255,i>>>16&255,i>>>8&255,i&255),m},A.prototype.array=A.prototype.digest,A.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(this.is224?28:32),l=new DataView(t);return l.setUint32(0,this.h0),l.setUint32(4,this.h1),l.setUint32(8,this.h2),l.setUint32(12,this.h3),l.setUint32(16,this.h4),l.setUint32(20,this.h5),l.setUint32(24,this.h6),this.is224||l.setUint32(28,this.h7),t};function P(t,l,u){var c,p=typeof t;if(p==="string"){var s=[],d=t.length,i=0,m;for(c=0;c<d;++c)m=t.charCodeAt(c),m<128?s[i++]=m:m<2048?(s[i++]=192|m>>>6,s[i++]=128|m&63):m<55296||m>=57344?(s[i++]=224|m>>>12,s[i++]=128|m>>>6&63,s[i++]=128|m&63):(m=65536+((m&1023)<<10|t.charCodeAt(++c)&1023),s[i++]=240|m>>>18,s[i++]=128|m>>>12&63,s[i++]=128|m>>>6&63,s[i++]=128|m&63);t=s}else if(p==="object"){if(t===null)throw new Error(o);if(g&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!g||!ArrayBuffer.isView(t)))throw new Error(o)}else throw new Error(o);t.length>64&&(t=new A(l,!0).update(t).array());var v=[],_=[];for(c=0;c<64;++c){var C=t[c]||0;v[c]=92^C,_[c]=54^C}A.call(this,l,u),this.update(_),this.oKeyPad=v,this.inner=!0,this.sharedMemory=u}P.prototype=new A,P.prototype.finalize=function(){if(A.prototype.finalize.call(this),this.inner){this.inner=!1;var t=this.array();A.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(t),A.prototype.finalize.call(this)}};var O=V();O.sha256=O,O.sha224=V(!0),O.sha256.hmac=K(),O.sha224.hmac=K(!0),x?I.exports=O:(n.sha256=O.sha256,n.sha224=O.sha224)})()})(et)),et.exports}var it=dt(),Z={exports:{}},ut=Z.exports,ot;function xt(){return ot||(ot=1,(function(I){(function(){var o,a,n,e;for(n=(I!==null?I.exports:void 0)||(window.Base58={}),o="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",a={},e=0;e<o.length;)a[o.charAt(e)]=e,e++;n.encode=function(h){var x,g,r;if(h.length===0)return"";for(e=void 0,r=void 0,g=[0],e=0;e<h.length;){for(r=0;r<g.length;)g[r]<<=8,r++;for(g[0]+=h[e],x=0,r=0;r<g.length;)g[r]+=x,x=g[r]/58|0,g[r]%=58,++r;for(;x;)g.push(x%58),x=x/58|0;e++}for(e=0;h[e]===0&&e<h.length-1;)g.push(0),e++;return g.reverse().map(function(E){return o[E]}).join("")},n.decode=function(h){var x,g,r,E;if(h.length===0)return new(typeof Uint8Array<"u"&&Uint8Array!==null?Uint8Array:Buffer)(0);for(e=void 0,E=void 0,x=[0],e=0;e<h.length;){if(g=h[e],!(g in a))throw"Base58.decode received unacceptable input. Character '"+g+"' is not in the Base58 alphabet.";for(E=0;E<x.length;)x[E]*=58,E++;for(x[0]+=a[g],r=0,E=0;E<x.length;)x[E]+=r,r=x[E]>>8,x[E]&=255,++E;for(;r;)x.push(r&255),r>>=8;e++}for(e=0;h[e]==="1"&&e<h.length-1;)x.push(0),e++;return new(typeof Uint8Array<"u"&&Uint8Array!==null?Uint8Array:Buffer)(x.reverse())}}).call(ut)})(Z)),Z.exports}var at=xt();document.addEventListener("DOMContentLoaded",()=>{const I=document.createElement("script");I.src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js",I.onload=()=>console.log("QRCode.js loaded."),document.head.appendChild(I);const o=document.getElementById("modeSplitBtn"),a=document.getElementById("modeReconstructBtn"),n=document.getElementById("splitSection"),e=document.getElementById("reconstructSection"),h=document.getElementById("originalString"),x=document.getElementById("n"),g=document.getElementById("k"),r=document.getElementById("kErrorMessage"),E=document.getElementById("generateBtn"),k=document.getElementById("clearSplitBtn"),U=document.getElementById("splitError"),H=document.getElementById("splitResultArea"),w=document.querySelector("#splitResultTable tbody"),Q=document.getElementById("queueProgress"),V=document.getElementById("queueList"),G=document.getElementById("customShareInput"),X=document.getElementById("addCustomShareBtn"),K=document.getElementById("reconstructBtn"),A=document.getElementById("clearQueueBtn"),P=document.getElementById("reconstructionResult"),O=document.getElementById("themeToggleBtn"),t=document.getElementById("qrModal"),l=document.getElementById("qrCodeContainer"),u=document.getElementById("toast"),c=document.getElementById("encodingToggle"),p=document.querySelectorAll(".accordion-header");let s=null,d=[],i=[];document.getElementById("currentYear").textContent=new Date().getFullYear();const m="zanta-shamir-secret-sharing-theme",v=f=>{u.textContent=f,u.className="show",setTimeout(()=>{u.className=u.className.replace("show","")},3e3)},_=f=>{f==="split"?(o.classList.add("active"),a.classList.remove("active"),n.classList.add("active"),e.classList.remove("active")):(o.classList.remove("active"),a.classList.add("active"),n.classList.remove("active"),e.classList.add("active"))},C=f=>{U.textContent=f,U.style.display="block"},T=()=>{U.style.display="none"},y=(f,b)=>{P.textContent=f,P.className=`output-box ${b}`,P.style.display="block"},j=()=>{P.style.display="none"},R=()=>{V.innerHTML="";const f=s?s.k:d.length>=2?"k?":"?";d.length===0?Q.textContent="è«‹å…ˆç”¢ç”Ÿæˆ–æ‰‹å‹•åŠ å…¥åˆ†å‰²å€¼":Q.textContent=`å·²é¸æ“‡ ${d.length} / ${f} ä»½åˆ†å‰²å€¼`,d.forEach(F=>{const S=document.createElement("div");S.className="queue-item";const B=`ID: ${F.id}`,M=document.createElement("span");M.textContent=`${B}`,S.appendChild(M);const N=document.createElement("button");N.textContent="ç§»é™¤",N.onclick=()=>{d=d.filter(L=>L.id!==F.id),R()},S.appendChild(N),V.appendChild(S)});let b=!1;s?b=d.length>=s.k:b=d.length>=(parseInt(g.value)||2),K.disabled=!b},J=f=>{if(d.some(b=>b.id===f.id)){v(`ID ç‚º ${f.id} çš„åˆ†å‰²å€¼å·²åœ¨ä½‡åˆ—ä¸­ã€‚`);return}d.push(f),R(),_("reconstruct")},q=()=>{const f=x.value,b=g.value;let F=!0;if(r.textContent="",document.getElementById("nErrorMessage").textContent="",f===""&&b==="")return E.disabled=!0,!1;const S=parseInt(f),B=parseInt(b);return(f===""||isNaN(S)||S<2||S>255)&&(document.getElementById("nErrorMessage").textContent="n å¿…é ˆæ˜¯ 2 åˆ° 255 ä¹‹é–“çš„æ•¸å­—",F=!1),(b===""||isNaN(B)||B<2||B>255)&&(r.textContent="k å¿…é ˆæ˜¯ 2 åˆ° 255 ä¹‹é–“çš„æ•¸å­—",F=!1),F&&B>S&&(r.textContent="k (é–€æª»å€¼) ä¸èƒ½å¤§æ–¼ n (ç¸½åˆ†å‰²æ•¸)",F=!1),E.disabled=!F,F};function z(f,b){w.innerHTML="",f.forEach(F=>{let S;const B=JSON.stringify(F);if(b==="base58"){const tt=new TextEncoder().encode(B);S=at.encode(tt)}else S=btoa(B);const M=w.insertRow();M.insertCell(0).textContent=F.id,M.insertCell(1).textContent=S;const N=M.insertCell(2),L=document.createElement("div");L.className="action-button-container";const $=document.createElement("button");$.textContent="åŠ å…¥",$.title="åŠ å…¥é‡å»ºä½‡åˆ—",$.className="action-btn",$.onclick=()=>J({id:F.id,value:F.share});const W=document.createElement("button");W.textContent="è¤‡è£½",W.title="è¤‡è£½ç·¨ç¢¼å¾Œçš„åˆ†å‰²å€¼",W.className="action-btn secondary",W.onclick=()=>{navigator.clipboard.writeText(S).then(()=>v(`ID ${F.id} çš„åˆ†å‰²å€¼å·²è¤‡è£½ï¼`)).catch(tt=>v("è¤‡è£½å¤±æ•—: "+tt))};const Y=document.createElement("button");Y.textContent="QR",Y.title="ç”¢ç”Ÿæ­¤åˆ†å‰²å€¼çš„ QR Code",Y.className="action-btn qr",Y.onclick=()=>{l.innerHTML="",typeof QRCode<"u"?(new QRCode(l,{text:S,width:256,height:256,colorDark:document.documentElement.getAttribute("data-theme")==="dark"?"#e8e8f0":"#000000",colorLight:document.documentElement.getAttribute("data-theme")==="dark"?"#2f2f4f":"#ffffff",correctLevel:QRCode.CorrectLevel.M}),t.style.display="flex"):C("QR Code å‡½å¼åº«è¼‰å…¥å¤±æ•—ã€‚")},L.appendChild($),L.appendChild(W),L.appendChild(Y),N.appendChild(L)})}x.addEventListener("input",q),g.addEventListener("input",q),o.addEventListener("click",()=>_("split")),a.addEventListener("click",()=>_("reconstruct")),E.addEventListener("click",()=>{T(),H.style.display="none";try{const f=h.value,b=parseInt(x.value),F=parseInt(g.value);if(f===""&&!confirm("æ‚¨ç¢ºå®šè¦åˆ†äº«ä¸€å€‹ç©ºå­—ä¸²å—ï¼Ÿ"))return;if(!x.value||!g.value)throw new Error("n å’Œ k çš†å¿…é ˆå¡«å¯«ã€‚");if(!q()){C("è«‹ä¿®æ­£ n æˆ– k çš„éŒ¯èª¤ã€‚");return}s=new rt(f,b,F),i=s.generateShares().map(M=>{const N={v:"1.2",n:s.n,k:s.k,p:"1D",enc:"utf8",pad:"secrets.js-1bit",cs:"sha256-4",id:M.id,share:M.value},L=it.sha256(JSON.stringify(N)).substring(0,8);return N.chk=L,N});const B=c.checked?"base58":"base64";z(i,B),H.style.display="block",d=[],R()}catch(f){console.error("Generate Error:",f),C(`éŒ¯èª¤: ${f.message}`)}}),c.addEventListener("change",f=>{const b=f.target.checked?"base58":"base64";i.length>0&&z(i,b)}),k.addEventListener("click",()=>{h.value="",x.value="",g.value="",r.textContent="",document.getElementById("nErrorMessage").textContent="",T(),H.style.display="none",s=null,d=[],i=[],R(),q()}),X.addEventListener("click",()=>{j();try{const f=G.value.trim();if(!f)throw new Error("è¼¸å…¥ä¸èƒ½ç‚ºç©ºã€‚");let b;try{b=atob(f)}catch{try{const $=at.decode(f);b=new TextDecoder().decode($)}catch{throw new Error("ç„¡æ³•è§£æè¼¸å…¥ï¼Œè«‹ç¢ºèªå…¶ç‚ºæœ‰æ•ˆçš„ Base64 æˆ– Base58Check ç·¨ç¢¼ã€‚")}}const F=JSON.parse(b),{chk:S,...B}=F;if(!S)throw new Error("æ ¼å¼ä¸æ­£ç¢ºï¼šç¼ºå°‘æ ¡é©—ç¢¼ (chk) æ¬„ä½ã€‚");const M=it.sha256(JSON.stringify(B)).substring(0,8);if(S!==M)throw new Error("Checksum é©—è­‰å¤±æ•—ï¼æ­¤åˆ†å‰²å€¼å¯èƒ½å·²ææ¯€æˆ–è¢«ç«„æ”¹ã€‚");B.v!=="1.2"&&B.v!=="1.1"&&console.warn(`[ç›¸å®¹æ€§è­¦å‘Š] æ­¤åˆ†å‰²å€¼ç‰ˆæœ¬ç‚º ${B.v}ï¼Œç›®å‰ç‰ˆæœ¬ç‚º 1.2ã€‚`),B.v==="1.2"&&(!B.pad||B.pad!=="secrets.js-1bit")&&console.warn("[ç›¸å®¹æ€§è­¦å‘Š] æ­¤ v1.2 åˆ†å‰²å€¼ç¼ºå°‘ 'pad' æ¬„ä½æˆ– 'pad' é¡å‹ä¸å—æ”¯æ´ã€‚å°‡å‡å®šä½¿ç”¨ 'secrets.js-1bit' æ–¹æ¡ˆé€²è¡Œé‡å»ºã€‚");const N={id:B.id,value:B.share};if(typeof N.id!="number"||!Array.isArray(N.value))throw new Error("Base64 è§£ç¢¼å¾Œçš„æ ¼å¼ä¸æ­£ç¢ºï¼Œç¼ºå°‘ id æˆ– share (å¿…é ˆæ˜¯é™£åˆ—) æ¬„ä½ã€‚");if(!N.value.every(L=>typeof L=="number"&&L>=0&&L<=255))throw new Error("åˆ†å‰²å€¼ä¸­çš„ share é™£åˆ—åŒ…å«ç„¡æ•ˆçš„æ•¸å­— (æ‡‰ç‚º 0-255 ä¹‹é–“çš„æ•¸å­—)ã€‚");J(N),G.value=""}catch(f){console.error("Add Custom Share Error:",f),y(`åŠ å…¥å¤±æ•—: ${f.message}`,"error")}}),A.addEventListener("click",()=>{d=[],j(),R()}),K.addEventListener("click",()=>{try{if(d.length===0)throw new Error("é‡å»ºä½‡åˆ—æ˜¯ç©ºçš„ã€‚è«‹åŠ å…¥åˆ†å‰²å€¼ã€‚");let f=s?s.k:parseInt(g.value),b=s?s.n:parseInt(x.value);if(isNaN(f)||f<2)if(d.length>0&&d[0].k)f=d[0].k;else throw new Error("éŒ¯èª¤ï¼šç„¡æ³•ç¢ºå®šé‡å»ºæ‰€éœ€çš„é–€æª»å€¼ (k)ã€‚è«‹åœ¨ã€Œåˆ†å‰²ã€é é¢è¨­å®š k å€¼ï¼Œæˆ–ä½¿ç”¨ v1.1+ æ ¼å¼çš„åˆ†å‰²å€¼ã€‚");if(d.length<f)throw new Error(`éœ€è¦ ${f} ä»½åˆ†å‰²å€¼ï¼Œç›®å‰åªæœ‰ ${d.length} ä»½ã€‚`);let F=s;F||((isNaN(b)||b<f||b>255)&&(b=255),F=new rt("temp",b,f));const S=F.reconstructSecret(d);y(S,"success")}catch(f){console.error("Reconstruct Error:",f),y(`é‡å»ºå¤±æ•—: ${f.message}`,"error")}}),t.addEventListener("click",f=>{f.target===t&&(t.style.display="none")});const D=f=>{document.documentElement.setAttribute("data-theme",f),O.textContent=f==="dark"?"â˜€ï¸":"ğŸŒ™",localStorage.setItem(m,f)};O.addEventListener("click",()=>{const f=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";D(f)}),p.forEach(f=>{f.addEventListener("click",()=>{const b=f.nextElementSibling;f.getAttribute("aria-expanded")==="true"?(f.setAttribute("aria-expanded","false"),b.style.display="none"):(f.setAttribute("aria-expanded","true"),b.style.display="block")})}),D(localStorage.getItem(m)||"dark"),q(),R()});
