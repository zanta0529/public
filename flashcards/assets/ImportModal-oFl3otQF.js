import{r as s,j as e,a as h,z as i}from"./index-DpD5LOw_.js";import{c as C}from"./cardService-Dr3V7M-O.js";function I({isOpen:f,onClose:d,onSuccess:y}){const[n,c]=s.useState(""),[a,p]=s.useState(!1),[x,v]=s.useState("auto"),[m,k]=s.useState(!1),[u,g]=s.useState(null);if(!f)return null;const S=async()=>{if(!n.trim())return;if(!h.hasKey()){i.error("Please set your Gemini API Key in Settings first.");return}p(!0),g(null);const t=i.loading("AI is analyzing transcript...");try{const o=await h.analyzeTranscript(n,x);if(!Array.isArray(o)||o.length===0)throw new Error("AI found no vocabulary or returned invalid format.");i.loading(`Found ${o.length} words. Saving...`,{id:t});const l=JSON.stringify(o),b=await C.importCards(l,{smartDeduplication:m});i.success(`Success!
Added: ${b.addedCount}
Skipped (Duplicate): ${b.skippedCount}`,{id:t,duration:4e3}),c(""),y(),d()}catch(o){console.error(o);const l=o.message||"Unknown error";g(l),i.error(`Failed: ${l}`,{id:t})}finally{p(!1),setTimeout(()=>i.dismiss(t),3e3)}},j=[{label:"AUTO",value:"auto"},{label:"5",value:5},{label:"10",value:10},{label:"20",value:20}];return e.jsx("div",{style:r.overlay,children:e.jsxs("div",{style:r.modal,children:[e.jsx("h2",{style:{marginTop:0,color:"#fff",marginBottom:"1.5rem"},children:"Import from Podcast"}),e.jsxs("div",{style:r.settingsContainer,children:[e.jsxs("div",{style:r.settingRow,children:[e.jsx("span",{style:r.settingLabel,children:"Max Words:"}),e.jsx("div",{style:r.optionGroup,children:j.map(t=>e.jsx("button",{onClick:()=>v(t.value),style:{...r.optionBtn,...x===t.value?r.optionBtnActive:{}},children:t.label},t.value))})]}),e.jsx("div",{style:r.settingRow,children:e.jsxs("label",{style:r.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:m,onChange:t=>k(t.target.checked),style:r.checkbox}),e.jsxs("div",{style:r.checkboxText,children:[e.jsx("span",{style:{color:"#e0e0e0",fontWeight:"500"},children:"Enable AI Smart Deduplication"}),e.jsx("span",{style:r.helperText,children:'Slower, but accurately detects synonyms (e.g. "make angry" vs "provoke").'})]})]})})]}),e.jsx("p",{style:{color:"#aaa",fontSize:"0.9rem",marginBottom:"0.5rem"},children:"Paste the full podcast transcript text below. Gemini will extract key vocabulary for you."}),e.jsx("textarea",{value:n,onChange:t=>c(t.target.value),placeholder:"Paste transcript text here...",style:r.textarea,disabled:a}),u&&e.jsxs("div",{style:r.error,children:["‚ùå ",u]}),e.jsxs("div",{style:r.actions,children:[e.jsx("button",{onClick:d,disabled:a,style:{...r.btn,backgroundColor:"#555"},children:"Cancel"}),e.jsx("button",{onClick:S,disabled:a||!n.trim(),style:{...r.btn,backgroundColor:a?"#777":"#6366f1",opacity:!n.trim()||a?.6:1},children:a?"Analyzing...":"Analyze & Import"})]})]})})}const r={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(3px)"},modal:{backgroundColor:"#1e2024",padding:"2rem",borderRadius:"12px",width:"90%",maxWidth:"600px",boxShadow:"0 10px 25px rgba(0,0,0,0.5)",border:"1px solid #333"},settingsContainer:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"8px",border:"1px solid #2c2e33"},settingRow:{display:"flex",alignItems:"center",marginBottom:"1rem",gap:"1rem",flexWrap:"wrap"},settingLabel:{color:"#ccc",fontSize:"0.9rem",fontWeight:"500",minWidth:"80px"},optionGroup:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},optionBtn:{padding:"0.4rem 1rem",backgroundColor:"#2c2e33",border:"1px solid #444",borderRadius:"6px",color:"#aaa",cursor:"pointer",fontSize:"0.9rem",transition:"all 0.2s ease"},optionBtnActive:{backgroundColor:"#6366f1",color:"#fff",borderColor:"#6366f1",boxShadow:"0 0 8px rgba(99, 102, 241, 0.4)"},checkboxLabel:{display:"flex",alignItems:"flex-start",cursor:"pointer",gap:"0.8rem"},checkbox:{marginTop:"0.3rem",width:"18px",height:"18px",cursor:"pointer",accentColor:"#6366f1"},checkboxText:{display:"flex",flexDirection:"column",gap:"0.2rem"},helperText:{color:"#888",fontSize:"0.8rem",lineHeight:"1.4"},textarea:{width:"100%",height:"250px",backgroundColor:"#131416",color:"#e0e0e0",border:"1px solid #444",borderRadius:"6px",padding:"0.8rem",fontFamily:"inherit",fontSize:"0.95rem",resize:"vertical",lineHeight:"1.5",boxSizing:"border-box"},error:{color:"#ff6b6b",marginTop:"1rem",fontSize:"0.9rem",padding:"0.5rem",backgroundColor:"rgba(255, 107, 107, 0.1)",borderRadius:"4px"},actions:{display:"flex",justifyContent:"flex-end",gap:"1rem",marginTop:"1.5rem"},btn:{padding:"0.6rem 1.5rem",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"1rem"}};export{I as default};
